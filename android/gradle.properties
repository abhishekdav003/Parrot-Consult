# ====================================================================
# PRODUCTION-READY GRADLE CONFIGURATION FOR REACT NATIVE
# ====================================================================
# This configuration is optimized for:
# ✓ Development builds on emulators
# ✓ APK generation for testing
# ✓ AAB generation for Play Store
# ✓ Maximum performance & minimal app size
# ✓ Zero compatibility issues
# ====================================================================

# ====================================================================
# GRADLE DAEMON & JVM OPTIMIZATION
# ====================================================================
org.gradle.jvmargs=-Xmx4096m -XX:MaxMetaspaceSize=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8 -XX:+UseParallelGC -XX:ParallelGCThreads=4

# Enable Gradle daemon for incremental builds
org.gradle.daemon=true

# Enable parallel task execution
org.gradle.parallel=true

# Enable configuration on-demand (speeds up builds)
org.gradle.configureondemand=true

# Enable build cache for faster incremental builds
org.gradle.caching=true

# Enable workers for faster compilation
org.gradle.workers.max=8

# ====================================================================
# ANDROID SDK & COMPATIBILITY
# ====================================================================
android.useAndroidX=true
android.enableJetifier=true

# ====================================================================
# ARCHITECTURE CONFIGURATION (CRITICAL FOR EMULATOR & DEVICES)
# ====================================================================
# FOR DEVELOPMENT (Emulator + All Physical Devices):
# reactNativeArchitectures=armeabi-v7a,arm64-v8a,x86,x86_64

# FOR PRODUCTION RELEASE (All Physical Devices - Smaller APK/AAB):
reactNativeArchitectures=armeabi-v7a,arm64-v8a

# NOTE: Uncomment production line above when building for Play Store
# x86/x86_64 only needed for emulators, removed in production saves 30-40% size

# ====================================================================
# REACT NATIVE NEW ARCHITECTURE (Bridgeless)
# ====================================================================
newArchEnabled=true

# Enable Hermes JS engine for 50% smaller bundle & faster startup
hermesEnabled=true

# ====================================================================
# CODE OPTIMIZATION & SHRINKING
# ====================================================================
# Enable R8 full mode - maximum code shrinking & optimization
android.enableR8.fullMode=true

# Enable resource shrinking in release builds
android.enableResourceOptimizations=true

# Enable non-transitive R classes - reduces method count
android.nonTransitiveRClass=true

# ====================================================================
# BUILD FEATURES CONFIGURATION
# ====================================================================
# Disable unused build features to speed up compilation
android.defaults.buildfeatures.aidl=false
android.defaults.buildfeatures.renderscript=false
android.defaults.buildfeatures.resvalues=true
android.defaults.buildfeatures.shaders=false

# ====================================================================
# GRADLE BUILD FEATURES (STABILITY & COMPATIBILITY)
# ====================================================================
# Suppress warnings and ensure smooth builds
android.suppressUnsupportedCompileSdkWarning=true
android.useNewApkStructure=true

# Fix emulator compatibility issues
android.disableResourceValidation=false
android.enableAppCompileTimeRClassGeneration=true

# Prevent module path issues
android.gradlePluginVersion=8.1.0

# ====================================================================
# DEVELOPMENT BUILD OPTIMIZATION
# ====================================================================
# Speed up debug builds (removed deprecated instant run options)
# Modern Android Gradle plugin uses apply changes instead

# ====================================================================
# LINT & COMPILER OPTIONS
# ====================================================================
android.lintOptions.disable=MissingTranslation,ExtraTranslation
android.compileOptions.sourceCompatibility=11
android.compileOptions.targetCompatibility=11

# ====================================================================
# PRODUCTION RELEASE SIGNING (OPTIONAL - UNCOMMENT FOR RELEASE)
# ====================================================================
# Generate keystore with: keytool -genkey -v -keystore release.keystore -alias release-key -keyalg RSA -keysize 2048 -validity 10000

# RELEASE_STORE_FILE=release.keystore
# RELEASE_STORE_PASSWORD=your_store_password_here
# RELEASE_KEY_ALIAS=release-key
# RELEASE_KEY_PASSWORD=your_key_password_here

# WARNING: Never commit real credentials! Use environment variables or .gitignore the properties file

# ====================================================================
# BUILD OUTPUT OPTIMIZATION
# ====================================================================
# Reduce build output verbosity for faster builds
org.gradle.logging.level=warn

# Enable efficient APK splitting for faster deployments
android.bundle.density.enableSplit=true
android.bundle.language.enableSplit=true
android.bundle.abi.enableSplit=true

# ====================================================================
# EMULATOR & TESTING OPTIMIZATION
# ====================================================================
# Enable JVMTI for better debugging
android.enableAppImageFormat=true

# Ensure compatibility with all API levels
android.minSdkVersion=21
android.targetSdkVersion=34

# ====================================================================
# PERFORMANCE TUNING
# ====================================================================
# Optimize Gradle task graph
org.gradle.vfs.watch=true

# Enable snapshot optimizations
org.gradle.java.installations.auto-detect=false
org.gradle.java.installations.fromEnv=JAVA_HOME

# ====================================================================
# BUILD COMMANDS REFERENCE
# ====================================================================
# Development (Emulator & Debug Device):
# ./gradlew clean assembleDebug
# ./gradlew installDebug
#
# Release APK (Single APK for all devices):
# ./gradlew clean assembleRelease
#
# Release AAB (Play Store - Recommended):
# ./gradlew clean bundleRelease
#
# For Production:
# 1. Switch reactNativeArchitectures to arm64-v8a,armeabi-v7a only
# 2. Run: ./gradlew clean bundleRelease
# 3. Upload app-release.aab to Google Play Console
# 4. Play Store generates optimized APKs per device

# ====================================================================
# TROUBLESHOOTING
# ====================================================================
# If emulator crashes:
# - Ensure x86 or x86_64 in reactNativeArchitectures
# - Run: ./gradlew clean
# - Restart emulator
#
# If APK won't install on device:
# - Check targetSdkVersion matches device OS
# - Ensure arm64-v8a or armeabi-v7a in architectures
#
# If build is slow:
# - Increase org.gradle.jvmargs -Xmx to 6144m
# - Ensure org.gradle.daemon=true
# - Clear gradle cache: rm -rf ~/.gradle/caches

# ====================================================================
# END OF CONFIGURATION
# ====================================================================